<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Emacs on Microsoft Windows</title>
<!-- 2018-03-19 Mon 14:23 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="description" content="Emacs programming and customization."
 />
<meta  name="keywords" content="emacs, shell, eshell, windows, microsoft, cmd.exe" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link href="theme/style.css" rel="stylesheet">
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://orgmode.org/mathjax/MathJax.js"></script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Emacs on Microsoft Windows</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Emacs on Microsoft Windows</a>
<ul>
<li><a href="#sec-1-1">1.1. Overview</a></li>
<li><a href="#sec-1-2">1.2. Getting Emacs and Useful tools</a>
<ul>
<li><a href="#sec-1-2-1">1.2.1. Getting Emacs</a></li>
<li><a href="#sec-1-2-2">1.2.2. Getting Unix utilities</a></li>
</ul>
</li>
<li><a href="#sec-1-3">1.3. Useful Tweaking</a>
<ul>
<li><a href="#sec-1-3-1">1.3.1. Setting Environments Variables</a></li>
<li><a href="#sec-1-3-2">1.3.2. Invert Control and Capslock</a></li>
<li><a href="#sec-1-3-3">1.3.3. Initialization - init.el file.</a></li>
</ul>
</li>
<li><a href="#sec-1-4">1.4. Unix utilities</a></li>
<li><a href="#sec-1-5">1.5. Environment Variables in Emacs</a></li>
<li><a href="#sec-1-6">1.6. Shells</a>
<ul>
<li><a href="#sec-1-6-1">1.6.1. Eshell</a></li>
<li><a href="#sec-1-6-2">1.6.2. Powershell</a></li>
</ul>
</li>
<li><a href="#sec-1-7">1.7. Visual C++ MSVC Building Tools</a>
<ul>
<li><a href="#sec-1-7-1">1.7.1. Calling MSVC tools from Emacs</a></li>
<li><a href="#sec-1-7-2">1.7.2. Commands for MSVC2015</a></li>
<li><a href="#sec-1-7-3">1.7.3. Install C++ Compilers and MSVC Building Tools</a></li>
<li><a href="#sec-1-7-4">1.7.4. Build automation tools and batch files</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<a href="index.html">Top</a>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Emacs on Microsoft Windows</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Overview</h3>
<div class="outline-text-3" id="text-1-1">
<p>
<b>Why Emacs on Windows ?</b> 
</p>

<p>
Emacs provides many useful tools for Windows developers or anyone that
have to use Windows for professional reasons or use Windows at work
such as:
</p>

<ul class="org-ul">
<li><span class="underline">Powerful terminal emulator</span>: Emacs can be a powerful terminal
emulator for Windows and a outstanding replacement for cmd.exe
terminal emulator because it has history, multi line history and
multi line input and tiling windows where it is possible to split
the Emacs window and run a repl and edit a file on the same
window. Unlike cmd.exe Emacs can also run multiple REPLs in the
same window.
</li>

<li><span class="underline">Run any shell</span>: Emacs can run any shell application like Python,
IPython, Powershell, cmd.exe, bash, C# shell, F# and so on.
</li>

<li><span class="underline">Eshell</span>: Eshell is unix-like shell implemented in Elisp providing
many unix commands like ls, mv, cp, rm without any external
dependencies and it is also highly integrated to Emacs allowing the
user to call elisp functions, browser directories, open files
(visit buffer).
</li>

<li><span class="underline">Dired mode</span>: Dired mode allows fast directory navigation and to
run commands or apply shell commands on files like md5sum, rm -rf,
git add and so on.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> Getting Emacs and Useful tools</h3>
<div class="outline-text-3" id="text-1-2">
</div><div id="outline-container-sec-1-2-1" class="outline-4">
<h4 id="sec-1-2-1"><span class="section-number-4">1.2.1</span> Getting Emacs</h4>
<div class="outline-text-4" id="text-1-2-1">
<p>
Emacs 32 bits
</p>

<ul class="org-ul">
<li><a href="https://ftp.gnu.org/gnu/emacs/windows/">https://ftp.gnu.org/gnu/emacs/windows/</a>
</li>
</ul>

<p>
Emacs 64 bits - 64-Bit GNU Emacs for MS Windows with optimization. 
</p>

<ul class="org-ul">
<li><a href="https://sourceforge.net/projects/emacsbinw64/">https://sourceforge.net/projects/emacsbinw64/</a>
</li>
</ul>

<p>
Install using Chocolately Package Manager 
</p>

<ul class="org-ul">
<li><a href="https://chocolatey.org/packages?q=emacs">https://chocolatey.org/packages?q=emacs</a> 
</li>
</ul>

<p>
Emacs 64 bits unnoficial
</p>

<ul class="org-ul">
<li><a href="https://chocolatey.org/packages/emacs64">https://chocolatey.org/packages/emacs64</a>
</li>
</ul>

<div class="org-src-container">

<pre class="src src-sh">choco install emacs64
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-2-2" class="outline-4">
<h4 id="sec-1-2-2"><span class="section-number-4">1.2.2</span> Getting Unix utilities</h4>
<div class="outline-text-4" id="text-1-2-2">
<p>
Git for Windows provides many Unix utilities ported for Windows like
awk, cat, ls, chown, grep, find and etc.
</p>

<ul class="org-ul">
<li><a href="https://git-scm.com/download/win">https://git-scm.com/download/win</a>
</li>
</ul>

<pre class="example">
c:/Program Files/Git/usr/bin $ ls -l *.exe
-rwxrwxrwx   1 Administrators None        65017 2016-03-18 16:40 [.exe
-rwxrwxrwx   1 Administrators None        28991 2016-03-18 16:40 arch.exe
-rwxrwxrwx   1 Administrators None       581408 2015-05-21  2015 awk.exe
-rwxrwxrwx   1 Administrators None        37712 2016-03-18 16:40 base32.exe
-rwxrwxrwx   1 Administrators None        37712 2016-03-18 16:40 base64.exe
-rwxrwxrwx   1 Administrators None        30078 2016-03-18 16:40 basename.exe
-rwxrwxrwx   1 Administrators None      2063362 2016-07-13 16:00 bash.exe
-rwxrwxrwx   1 Administrators None        89618 2014-11-04  2014 bunzip2.exe
-rwxrwxrwx   1 Administrators None        89618 2014-11-04  2014 bzcat.exe
-rwxrwxrwx   1 Administrators None        89618 2014-11-04  2014 bzip2.exe
-rwxrwxrwx   1 Administrators None        14686 2014-11-04  2014 bzip2recover.exe
-rwxrwxrwx   1 Administrators None        74003 2016-03-01 17:15 captoinfo.exe
-rwxrwxrwx   1 Administrators None        51896 2016-03-18 16:40 cat.exe
-rwxrwxrwx   1 Administrators None        55848 2016-03-18 16:40 chcon.exe

...

-rwxrwxrwx   1 Administrators None       128615 2016-03-18 16:40 vdir.exe
-rwxrwxrwx   1 Administrators None      2335971 2016-04-09 11:08 view.exe
-rwxrwxrwx   1 Administrators None      2335971 2016-04-09 11:08 vim.exe
-rwxrwxrwx   1 Administrators None      2335971 2016-04-09 11:08 vimdiff.exe
-rwxrwxrwx   1 Administrators None        42100 2016-03-18 16:40 wc.exe
-rwxrwxrwx   1 Administrators None        29553 2015-07-20  2015 which.exe
-rwxrwxrwx   1 Administrators None        63429 2016-03-18 16:40 who.exe
-rwxrwxrwx   1 Administrators None        28054 2016-03-18 16:40 whoami.exe
-rwxrwxrwx   1 Administrators None       975360 2016-05-16 14:32 winpty-agent.exe
-rwxrwxrwx   1 Administrators None        41984 2016-05-16 14:32 winpty-debugserver.exe
-rwxrwxrwx   1 Administrators None       747008 2016-05-16 14:32 winpty.exe
-rwxrwxrwx   1 Administrators None        64058 2016-01-20 15:17 xargs.exe
-rwxrwxrwx   1 Administrators None        25299 2016-03-29 14:28 xmlwf.exe
-rwxrwxrwx   1 Administrators None        18954 2016-04-09 11:08 xxd.exe
-rwxrwxrwx   1 Administrators None        28580 2016-03-18 16:40 yes.exe
-rwxrwxrwx   1 Administrators None       173708 2014-11-04  2014 zipinfo.exe
</pre>

<p>
GNU Make is an useful build-automation tool and can be got from:
</p>

<ul class="org-ul">
<li><a href="https://chocolatey.org/packages/make/3.81.4">https://chocolatey.org/packages/make/3.81.4</a>
</li>
</ul>

<pre class="example">
$ choco install make
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> Useful Tweaking</h3>
<div class="outline-text-3" id="text-1-3">
</div><div id="outline-container-sec-1-3-1" class="outline-4">
<h4 id="sec-1-3-1"><span class="section-number-4">1.3.1</span> Setting Environments Variables</h4>
<div class="outline-text-4" id="text-1-3-1">
</div><ol class="org-ol"><li><a id="sec-1-3-1-1" name="sec-1-3-1-1"></a>Set HOME<br  /><div class="outline-text-5" id="text-1-3-1-1">
<p>
The HOME environment variable that has the default value
<span class="underline">/home/&lt;username&gt;)</span> on Linux sets the user's directory path.
</p>

<p>
This variable, which is equivalent to  _%USERPROFILE% _(<code>C:\\Users\&lt;username&gt;</code> ) 
is expected to be set by many Unix applications ported to Windows and it
also makes directory browser in Emacs and shells easier. 
</p>

<div class="org-src-container">

<pre class="src src-bat">C:\Users\arch&gt;echo %<span class="org-variable-name">USERPROFILE</span>%
C:\Users\arch
</pre>
</div>

<p>
It can be set permanently by using the commmand below on cmd.exe shell.
</p>

<div class="org-src-container">

<pre class="src src-bat">setx HOME %<span class="org-variable-name">USERPROFILE</span>%
</pre>
</div>

<p>
To test if the variable is set. Open a new cmd.exe shell and type:
</p>

<div class="org-src-container">

<pre class="src src-bat">C:\Users\arch&gt;echo %<span class="org-variable-name">HOME</span>%
C:\Users\arch
</pre>
</div>

<p>
<b>It allows to browser Windows directories as:</b>
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left">~</td>
<td class="left">C:\Users\arch</td>
</tr>

<tr>
<td class="left">~/Desktop</td>
<td class="left">C:\Users\arch\Documents</td>
</tr>

<tr>
<td class="left">~/.emacs.d</td>
<td class="left">C:\Users\arch\.emacs.d</td>
</tr>
</tbody>
</table>


<p>
<b>It also allows the commands:</b>
</p>

<p>
To open file <span class="underline">~/.emac.d/init.el</span>  (C:\Users\arch\.emacs.d\init.el)
</p>

<ul class="org-ul">
<li>C-x C-f find-file ~/.emac.d/init.el 
</li>
</ul>

<p>
To open directory (C:\Users\arch\Desktop)
</p>

<ul class="org-ul">
<li>C-x C-d ~/Desktop 
</li>
</ul>
</div>
</li>

<li><a id="sec-1-3-1-2" name="sec-1-3-1-2"></a>Set PATH<br  /><div class="outline-text-5" id="text-1-3-1-2">
<p>
Executables located in directories listed in PATH environment variable
can be invoked without its full path like ls, echo and who in
Unix-like OS or ipconfig, arp and whoami in Windows.
</p>

<div class="org-src-container">

<pre class="src src-bat">C:\Users\arch\bin&gt;echo %<span class="org-variable-name">PATH</span>%
C:\ProgramData\Oracle\Java\javapath;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem...
</pre>
</div>

<p>
By adding the directory ~/bin or C:\Users\&lt;user&gt;\bin to PATH variable
it makes easir to call command line applications from this directory
without specifing its full path from Emacs or shell (cmd.exe). It can
be done with:
</p>

<ul class="org-ul">
<li>Add the directory C:\Users\&lt;user&gt;\bin to %PATH% enviroment variable: 
</li>
</ul>

<div class="org-src-container">

<pre class="src src-bat">setx <span class="org-builtin">PATH</span> <span class="org-string">"%PATH%;%USERPROFILE%\bin"</span>
</pre>
</div>

<p>
It makes easeir to call C:\Users\&lt;user&gt;\bin\curl.exe from any
directory. Instead of write its full path the user can just run <code>$
curl.exe</code> or <code>$ curl</code>.
</p>
</div>
</li></ol>
</div>

<div id="outline-container-sec-1-3-2" class="outline-4">
<h4 id="sec-1-3-2"><span class="section-number-4">1.3.2</span> Invert Control and Capslock</h4>
<div class="outline-text-4" id="text-1-3-2">
<p>
The Ctrl (Control) key is one of the most used keys, although it is
one of the most inconvenient and ergonomically bad key to type
possible leading to strain injury when used often as in Emacs. On the
other hand, Capslock while in a convenient position is one of the most
useless keys as it is not used often and upper case letters can be
typed just by holding the shift key while typing the underlying
letter. Those problems can be overcome by mapping the Capslock key to
Ctrl and Ctrl to Capslock. On Windows it can be done by running the
commands below in the powershell as administrator and then rebooting or
by entering in the cmd.exe shell and typing $ powershell and then
pasting the mentioned commands.
</p>

<ul class="org-ul">
<li>Source: <a href="https://superuser.com/questions/949385/map-capslock-to-control-in-windows-10">Map capslock to ctrl - Stack Overflow</a>
</li>
</ul>

<div class="org-src-container">

<pre class="src src-sh">$<span class="org-variable-name">hexified</span> = <span class="org-string">"00,00,00,00,00,00,00,00,02,00,00,00,1d,00,3a,00,00,00,00,00"</span>.Split(<span class="org-string">','</span>) | % { <span class="org-string">"0x$_"</span>};
$<span class="org-variable-name">kbLayout</span> = <span class="org-string">'HKLM:\System\CurrentControlSet\Control\Keyboard Layout'</span>;
New-ItemProperty -Path $<span class="org-variable-name">kbLayout</span> -Name <span class="org-string">"Scancode Map"</span> -PropertyType Binary -Value ([byte[]]$<span class="org-variable-name">hexified</span>);
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-3-3" class="outline-4">
<h4 id="sec-1-3-3"><span class="section-number-4">1.3.3</span> Initialization - init.el file.</h4>
<div class="outline-text-4" id="text-1-3-3">
<p>
This section provides a minimal configuration for Windows to deal with
pitfalls and annoyances. 
</p>

<ul class="org-ul">
<li>Suppress startup screen
</li>
</ul>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">setq</span> inhibit-startup-message t)
</pre>
</div>

<ul class="org-ul">
<li>Suppress Windows annoying beep or bell - Visible bell 
</li>
</ul>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> visible-bell t)
</pre>
</div>

<ul class="org-ul">
<li>Do not open file or user dialog.
</li>
</ul>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">setq</span> use-file-dialog nil)
(<span class="org-keyword">setq</span> use-dialog-box nil)
</pre>
</div>

<ul class="org-ul">
<li>Use Unix's <code>\n</code> (LF- Line Feed) and utf instead of Windows <code>\r\n</code>
(CRLF - Carriage Return and Line Feed) as end of line character. It
may not be desirable if most files or project edited are for
Windows or building tools that may fail if the source file doens't
CRLF as line ending. 
</li>
</ul>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">setq-default</span> buffer-file-coding-system 'utf-8-unix)
</pre>
</div>

<ul class="org-ul">
<li>UTF8 Everywhere 
</li>
</ul>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(set-terminal-coding-system 'utf-8)
(set-language-environment 'utf-8)
(set-keyboard-coding-system 'utf-8)
(prefer-coding-system 'utf-8)
(<span class="org-keyword">setq</span> locale-coding-system 'utf-8)
(set-default-coding-systems 'utf-8)
(set-terminal-coding-system 'utf-8)
</pre>
</div>

<ul class="org-ul">
<li>Separate Customization file from init.el 
</li>
</ul>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">setq</span> custom-file <span class="org-string">"~/.emacs.d/custom.el"</span>)
(load custom-file 'noerror)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> Unix utilities</h3>
<div class="outline-text-3" id="text-1-4">
<p>
You can bash install with Chocolately package manager or download GIT
version control app that comes bundled with bash and Unix utilities
like grep, mv, ssh, df and dd.
</p>

<p>
Command to run Bash. Usage: M-x run-bash 
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">run-bash</span> ()
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">let</span> ((shell-file-name <span class="org-string">"C:\\Program Files\\Git\\bin\\bash.exe"</span>))
            (shell <span class="org-string">"*bash*"</span>)))
</pre>
</div>


<p>
Command to run cmd.exe. Usage: M-x run-cmdexe 
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">run-cmdexe</span> ()
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">let</span> ((shell-file-name <span class="org-string">"cmd.exe"</span>))
            (shell <span class="org-string">"*cmd.exe*"</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5"><span class="section-number-3">1.5</span> Environment Variables in Emacs</h3>
<div class="outline-text-3" id="text-1-5">
<p>
To run Unix utilities and other command lines apps in Emacs add to the
PATH system environment variable the path to their directories like this:
</p>


<div class="org-src-container">

<pre class="src src-elisp">(setenv  <span class="org-string">"PATH"</span> (concat

                <span class="org-comment-delimiter">;; </span><span class="org-comment">"c:/Windows/System32" ";" </span>

                 <span class="org-string">"c:/Windows/Microsoft.NET/Framework/v4.0.30319"</span> <span class="org-string">";"</span>

                 <span class="org-string">"C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319"</span> <span class="org-string">";"</span>

                 <span class="org-comment-delimiter">;; </span><span class="org-comment">Unix tools </span>
                 <span class="org-string">"C:\\Program Files\\Git\\usr\\bin"</span> <span class="org-string">";"</span>

                 <span class="org-comment-delimiter">;; </span><span class="org-comment">User binary files </span>
                 <span class="org-string">"C:\\User\\arch\\bin"</span> <span class="org-string">";"</span>

                 <span class="org-comment-delimiter">;; </span><span class="org-comment">Mono Installation.</span>
                 <span class="org-string">"c:\\Program Files\\Mono\\bin"</span> <span class="org-string">";"</span>

                 <span class="org-string">"c:\\Program Files\\Mono\\lib\\mono\\4.5"</span> <span class="org-string">";"</span>

                 (getenv <span class="org-string">"PATH"</span>)

         ))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6"><span class="section-number-3">1.6</span> Shells</h3>
<div class="outline-text-3" id="text-1-6">
</div><div id="outline-container-sec-1-6-1" class="outline-4">
<h4 id="sec-1-6-1"><span class="section-number-4">1.6.1</span> Eshell</h4>
<div class="outline-text-4" id="text-1-6-1">
</div><ol class="org-ol"><li><a id="sec-1-6-1-1" name="sec-1-6-1-1"></a>Overview<br  /><div class="outline-text-5" id="text-1-6-1-1">
<p>
Eshell provides many benefits to Windows users: 
</p>

<ul class="org-ul">
<li>Many unix like commands implemented on Emacs' Lisp like: mv, cp, which &#x2026;
</li>

<li>Completion
</li>

<li>History: C-c C-l 
</li>

<li>Easy copy and paste unlike cmd.exe
</li>

<li>Integration with Eamcs since it can run Emacs commands (interactive
functions) like shell commands.
</li>
</ul>
</div>
</li>

<li><a id="sec-1-6-1-2" name="sec-1-6-1-2"></a>Screenshots<br  /><div class="outline-text-5" id="text-1-6-1-2">

<div class="figure">
<p><a href="images/eshell-windows-demo1.png"><img src="images/eshell-windows-demo1.png" alt="eshell-windows-demo1.png" /></a>
</p>
</div>
</div>
</li>

<li><a id="sec-1-6-1-3" name="sec-1-6-1-3"></a>Demonstrations<br  /><ol class="org-ol"><li><a id="sec-1-6-1-3-1" name="sec-1-6-1-3-1"></a>Commands and history<br  /><div class="outline-text-6" id="text-1-6-1-3-1">
<p>
To open the history type: C-c C-l 
</p>


<div class="figure">
<p><a href="images/eshell-windows-demo1.gif"><img src="images/eshell-windows-demo1.gif" alt="eshell-windows-demo1.gif" /></a>
</p>
</div>
</div>
</li>

<li><a id="sec-1-6-1-3-2" name="sec-1-6-1-3-2"></a>Emacs Integration<br  /><div class="outline-text-6" id="text-1-6-1-3-2">
<p>
Eshell can run Emacs elisp commands (interactive functions) like
find-file, dired as ordinary shell commands like is shown above. 
</p>

<p>
The function <span class="underline">find-file</span> can be executed in eshell as shell command
<code>find-file ~/.emacs.d/init.el</code> .
</p>

<div class="org-src-container">

<pre class="src src-elisp">(find-file <span class="org-string">"~/.emacs.d/init.el"</span>)
</pre>
</div>

<p>
Some useful Elisp commands on Eshell:
</p>

<p>
Open file:
</p>

<ul class="org-ul">
<li>find-file
</li>
<li>find-file-other-window
</li>
<li>find-file-other-frame 
</li>
</ul>

<p>
Open directory:
</p>

<ul class="org-ul">
<li>dired
</li>
<li>dired-other-window 
</li>
<li>dired-other-frame
</li>
</ul>
</div>
</li>

<li><a id="sec-1-6-1-3-3" name="sec-1-6-1-3-3"></a>Asyncrhonous Commands<br  /><div class="outline-text-6" id="text-1-6-1-3-3">
<pre class="example">
~/Desktop $ notepad.exe &amp;
</pre>
</div>
</li>

<li><a id="sec-1-6-1-3-4" name="sec-1-6-1-3-4"></a>Copy command output to clibpoard<br  /><div class="outline-text-6" id="text-1-6-1-3-4">
<p>
Eshell comes with a pseudo clipboard device /dev/kill that is useful
to handle clipboard.
</p>


<p>
<b>Copy command output to clibpboard</b>
</p>

<div class="org-src-container">

<pre class="src src-sh">~/Desktop $ ipconfig.exe &gt; /dev/kill
</pre>
</div>

<p>
<b>Show clibpoard content</b>
</p>
</div>
</li>

<li><a id="sec-1-6-1-3-5" name="sec-1-6-1-3-5"></a>Shell Commands mixed with Emacs commands<br  /><div class="outline-text-6" id="text-1-6-1-3-5">
<p>
Note: split-string Is an Emacs function.
</p>

<p>
<b>Example 1:</b>
</p>

<div class="org-src-container">

<pre class="src src-sh">~/Desktop $ split-string $<span class="org-variable-name">PATH</span> <span class="org-string">";"</span> 

(<span class="org-comment-delimiter">#</span><span class="org-comment">("C:/Program Files (x86)/Microsoft SDKs/F#/4.0/Framework/v4.0" 0 59</span>
   (escaped t))
 <span class="org-comment-delimiter">#</span><span class="org-comment">("c:/Windows/System32" 0 19</span>
   (escaped t))
 <span class="org-comment-delimiter">#</span><span class="org-comment">("c:/Windows/Microsoft.NET/Framework/v4.0.30319" 0 45</span>
   (escaped t))
 <span class="org-comment-delimiter">#</span><span class="org-comment">("C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319" 0 45</span>
   (escaped t))
 <span class="org-comment-delimiter">#</span><span class="org-comment">("C:\\Program Files\\Git\\usr\\bin" 0 28</span>
   (escaped t))
 <span class="org-comment-delimiter">#</span><span class="org-comment">("C:\\User\\arch\\bin" 0 16</span>
   (escaped t))
 <span class="org-comment-delimiter">#</span><span class="org-comment">("c:\\Program Files\\Mono\\bin" 0 25</span>
   (escaped t))
 <span class="org-comment-delimiter">#</span><span class="org-comment">("c:\\Program Files\\Mono\\lib\\mono\\4.5" 0 34</span>
   (escaped t))
 <span class="org-string">""</span>)
~/Desktop $
</pre>
</div>


<p>
<b>Exmaple 2:</b>
</p>

<div class="org-src-container">

<pre class="src src-sh">~/Desktop $ for m<span class="org-keyword"> in</span> {split-string $<span class="org-variable-name">PATH</span> <span class="org-string">";"</span>} {<span class="org-builtin">echo</span> $<span class="org-variable-name">m</span>}

C:/Program Files (x86)/Microsoft SDKs/F#/4.0/Framework/v4.0
c:/Windows/System32
c:/Windows/Microsoft.NET/Framework/v4.0.30319
C:\Windows\Microsoft.NET\Framework\v4.0.30319
C:\Program Files\Git\usr\bin
C:\User\arch\bin
c:\Program Files\Mono\bin
c:\Program Files\Mono\lib\mono\4.5
~/Desktop $
</pre>
</div>


<p>
<b>Example 3:</b>
</p>

<div class="org-src-container">

<pre class="src src-sh">~/Desktop $ for m<span class="org-keyword"> in</span> $<span class="org-variable-name">load</span>-path { <span class="org-builtin">echo</span> $<span class="org-variable-name">m</span>}

e:/projects/org-wiki
~/.emacs.d/packages
c:/Users/arch/.emacs.d/elpa/csharp-mode-20160901.319
c:/Users/arch/.emacs.d/elpa/fsharp-mode-20160719.315
c:/Users/arch/.emacs.d/elpa/flycheck-20160817.321
c:/Users/arch/.emacs.d/elpa/company-quickhelp-20160211.718
c:/Users/arch/.emacs.d/elpa/company-20160730.1516
c:/Users/arch/.emacs.d/elpa/helm-anything-20141126.231
c:/Users/arch/.emacs.d/elpa/anything-20160822.1852
c:/Users/arch/.emacs.d/elpa/helm-20160824.745
...
</pre>
</div>
</div>
</li></ol>
</li></ol>
</div>

<div id="outline-container-sec-1-6-2" class="outline-4">
<h4 id="sec-1-6-2"><span class="section-number-4">1.6.2</span> Powershell</h4>
<div class="outline-text-4" id="text-1-6-2">
<p>
This command runs Powershell on Emacs:
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">run-powershell</span> ()
  <span class="org-doc">"Run powershell"</span>
  (<span class="org-keyword">interactive</span>)
  (async-shell-command <span class="org-string">"c:/windows/system32/WindowsPowerShell/v1.0/powershell.exe -Command -"</span>
               nil
               nil))
</pre>
</div>

<p>
Usage: M-x run-powershell. 
</p>
</div>
</div>
</div>
<div id="outline-container-sec-1-7" class="outline-3">
<h3 id="sec-1-7"><span class="section-number-3">1.7</span> Visual C++ MSVC Building Tools</h3>
<div class="outline-text-3" id="text-1-7">
</div><div id="outline-container-sec-1-7-1" class="outline-4">
<h4 id="sec-1-7-1"><a id="ID-ea73a629-5cf0-4bd5-8b0f-ef0a418773f2" name="ID-ea73a629-5cf0-4bd5-8b0f-ef0a418773f2"></a><span class="section-number-4">1.7.1</span> Calling MSVC tools from Emacs</h4>
<div class="outline-text-4" id="text-1-7-1">

<p>
Calling the default and official Windows' C++ compiler MSVC (Microsoft
Visual C++) from command line is not easy as calling gcc, mingw or
clang as MSVC needs environment variables INCLUDE, LIB, LIBPATH and
PATH to be properly set with correct paths. Those settings depends on
the version of the compiler and the building target x86 (32 bits) or
x64 (64 bits), so the path settings of MSVC 2015 are different from
MSVC 2017. This section provides useful commands that solve this
problem by allowing the user call the compiler directly which may be
useful for studying c++ on Windows, learning about Windows API, testing
the compiler, building simple C++ programs or creating
proof-of-concepts.
</p>

<p>
Note: It was tested with MSVC 2017 and Windows10. 
</p>

<p>
To use it just copy the functions to the file ~/.init.el or emacs
intialization file.
</p>

<ul class="org-ul">
<li>Porgram: 
</li>
</ul>

<p>
Saves the original PATH variable 
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">msbuild-old-path-var</span> (getenv <span class="org-string">"PATH"</span>))
</pre>
</div>

<p>
This command sets environments variables for MSVC - 2017 Building tools and x68
building target. If the user runs <span class="underline">M-x msbuild-2017-x86-setup</span>, it will
allows to call the msvc compiler cl.exe with <span class="underline">M-x compile cl.exe file.cpp</span>. 
Then, the code will be compiled for x86 target. It is also possible to
call with M-x compile the commands msbuild.exe, link.exe (MSVC's linker) 
and dumpbin.exe (similar to GNU objdump).
</p>


<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">msbuild-2017-x86-setup</span> ()
  <span class="org-doc">"Set enviorment variables to load Microsoft Visual C++ Compiler (MSVC 32 bits)"</span>
  (<span class="org-keyword">interactive</span>)
  (message <span class="org-string">"Setting 32 bits MSVC building tools."</span>)
  (setenv <span class="org-string">"PATH"</span> msbuild-old-path-var)
  (setenv <span class="org-string">"INCLUDE"</span>
        (concat
             <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.12.25827/ATLMFC/include"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.12.25827/include"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/NETFXSDK/4.6.1/include/um"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/include/10.0.16299.0/ucrt"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/include/10.0.16299.0/shared"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/include/10.0.16299.0/um"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/include/10.0.16299.0/winrt"</span>
         ))

  (setenv <span class="org-string">"LIB"</span>
        (concat
             <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.12.25827/ATLMFC/lib/x86"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.12.25827/lib/x86"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/NETFXSDK/4.6.1/lib/um/x86"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/lib/10.0.16299.0/ucrt/x86"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/lib/10.0.16299.0/um/x86"</span>             
         ))

  (setenv  <span class="org-string">"LIBPATH"</span>
         (concat
              <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.12.25827/ATLMFC/lib/x86"</span>
          <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.12.25827/lib/x86"</span>
          <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.12.25827/lib/x86/store/references"</span>
          <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/UnionMetadata/10.0.16299.0"</span>
          <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/References/10.0.16299.0"</span>
          <span class="org-string">";"</span> <span class="org-string">"C:/Windows/Microsoft.NET/Framework/v4.0.30319"</span>
          ))

  (setenv <span class="org-string">"PATH"</span>
        (concat
         (getenv <span class="org-string">"PATH"</span>)
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.12.25827/bin/HostX86/x86"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/Common7/IDE/VC/VCPackages"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/Common7/IDE/CommonExtensions/Microsoft/TestWindow"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/Common7/IDE/CommonExtensions/Microsoft/TeamFoundation/Team Explorer"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/MSBuild/15.0/bin/Roslyn"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/Team Tools/Performance Tools"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/Shared/Common/VSPerfCollectionTools/"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft SDKs/Windows/v10.0A/bin/NETFX 4.6.1 Tools/"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft SDKs/F#/4.1/Framework/v4.0/"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/bin/x86"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/bin/10.0.16299.0/x86"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community//MSBuild/15.0/bin"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Windows/Microsoft.NET/Framework/v4.0.30319"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/Common7/IDE/"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/Common7/Tools/"</span>
         )))
</pre>
</div>

<p>
The command below sets enviroment variable for MSVC - 2017 and x64
building target and its similar to msbuild-2017-x86-setup. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">msbuild-2017-x64-setup</span> ()
  <span class="org-doc">"Set enviorment variables to load Microsoft Visual C++ Compiler (MSVC) 64 bits"</span>
  (<span class="org-keyword">interactive</span>)
  (message <span class="org-string">"Setting 64 bits building tools."</span>)
  (setenv <span class="org-string">"PATH"</span> msbuild-old-path-var)
  (setenv <span class="org-string">"INCLUDE"</span>
        (concat
             <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.12.25827/ATLMFC/include"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.12.25827/include"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/NETFXSDK/4.6.1/include/um"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/include/10.0.16299.0/ucrt"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/include/10.0.16299.0/shared"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/include/10.0.16299.0/um"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/include/10.0.16299.0/winrt"</span>
         ))

  (setenv <span class="org-string">"LIB"</span>
        (concat
             <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.12.25827/ATLMFC/lib/x64"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.12.25827/lib/x64"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/NETFXSDK/4.6.1/lib/um/x64"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/lib/10.0.16299.0/ucrt/x64"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/lib/10.0.16299.0/um/x64"</span>             
         ))

  (setenv  <span class="org-string">"LIBPATH"</span>
         (concat
              <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.12.25827/ATLMFC/lib/x64"</span>
          <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.12.25827/lib/x64"</span>
          <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.12.25827/lib/x64/store/references"</span>
          <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/UnionMetadata/10.0.16299.0"</span>
          <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/References/10.0.16299.0"</span>
          <span class="org-string">";"</span> <span class="org-string">"C:/Windows/Microsoft.NET/Framework/v4.0.30319"</span>
          ))

  (setenv <span class="org-string">"PATH"</span>
        (concat
         (getenv <span class="org-string">"PATH"</span>)
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.12.25827/bin/HostX86/x64"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/Common7/IDE/VC/VCPackages"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/Common7/IDE/CommonExtensions/Microsoft/TestWindow"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/Common7/IDE/CommonExtensions/Microsoft/TeamFoundation/Team Explorer"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/MSBuild/15.0/bin/Roslyn"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/Team Tools/Performance Tools"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/Shared/Common/VSPerfCollectionTools/"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft SDKs/Windows/v10.0A/bin/NETFX 4.6.1 Tools/"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft SDKs/F#/4.1/Framework/v4.0/"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/bin/x64"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/bin/10.0.16299.0/x64"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community//MSBuild/15.0/bin"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Windows/Microsoft.NET/Framework/v4.0.30319"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/Common7/IDE/"</span>
         <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/Common7/Tools/"</span>
         )))
</pre>
</div>

<p>
This command allows to compile the current buffer. For instance, if
the current buffer is associated to a file test1.cpp and user types
<span class="underline">M-x compile-msvc-x86</span>, it will show a prompt with <span class="underline">cl.exe test1.cpp</span>
asking the user to confirm or complement the compilation command.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">compile-msvc-x86</span>()
  (<span class="org-keyword">interactive</span>)
  (msbuild-2017-x86-setup)
  (<span class="org-keyword">let</span> ((compile-command (format <span class="org-string">"cl.exe \"%s\""</span>
                                 (file-name-nondirectory (buffer-file-name))))
        (compilation-ask-about-save nil))
    (call-interactively #'compile )))

(<span class="org-keyword">defun</span> <span class="org-function-name">compile-msvc-x64</span> ()
  (<span class="org-keyword">interactive</span>)
  (msbuild-2017-x64-setup)
  (<span class="org-keyword">let</span> ((compile-command (format <span class="org-string">"cl.exe \"%s\""</span>
                                 (file-name-nondirectory (buffer-file-name))))
        (compilation-ask-about-save nil))
    (call-interactively #'compile )))
</pre>
</div>

<p>
The screenshot below shows an example about how those commands can be
used: 
</p>


<div class="figure">
<p><a href="images/emacs-msvc-windows.png"><img src="images/emacs-msvc-windows.png" alt="emacs-msvc-windows.png" /></a>
</p>
</div>

<p>
Test file: <a href="codes/test.cpp"><a href="codes/test.cpp">codes/test.cpp</a></a>
</p>

<div class="org-src-container">

<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string">&lt;iostream&gt;</span>

<span class="org-keyword">using</span> <span class="org-keyword">namespace</span> <span class="org-constant">std</span>;

<span class="org-type">int</span> <span class="org-function-name">main</span>(){

  <span class="org-keyword">for</span>(<span class="org-type">int</span> <span class="org-variable-name">i</span> = 1 ; i &lt; 10; i ++)
    cout &lt;&lt; <span class="org-string">"Testing C++ on Emacs in Windows VM"</span> &lt;&lt; endl;

  <span class="org-keyword">return</span> 0;
}
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-7-2" class="outline-4">
<h4 id="sec-1-7-2"><span class="section-number-4">1.7.2</span> Commands for MSVC2015</h4>
<div class="outline-text-4" id="text-1-7-2">
<p>
M-x msbuild-2015-x86-setup and Set environment variables to allow
calling cl.exe for x86 build target and other tools from M-x
compile and shell commands.
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">msbuild-2015-x86-setup</span> ()
  (<span class="org-keyword">interactive</span>)
  <span class="org-string">"Set enviorment variables to load Microsoft Visual C++ Compiler 2015 (MSVC) 32 bits"</span>
  (setenv <span class="org-string">"PATH"</span> msbuild-old-path-var)
  (setenv <span class="org-string">"INCLUDE"</span>
          (concat 
           <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio 14.0/VC/INCLUDE"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/include/10.0.16299.0/ucrt"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/NETFXSDK/4.6.1/include/um"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/include/10.0.16299.0/shared"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/include/10.0.16299.0/um"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/include/10.0.16299.0/winrt"</span>
           ))
  (setenv <span class="org-string">"LIB"</span>
          (concat
           <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio 14.0/VC/LIB"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/lib/10.0.16299.0/ucrt/x86"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/NETFXSDK/4.6.1/lib/um/x86"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/lib/10.0.16299.0/um/x86"</span>
           ))
  (setenv <span class="org-string">"LIBPATH"</span>
          (concat 
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio 14.0/VC/LIB"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/WINDOWS/Microsoft.NET/Framework/v4.0.30319"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/WINDOWS/Microsoft.NET/Framework/"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/UnionMetadata"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/References"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/References/Windows.Foundation.UniversalApiContract/1.0.0.0"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/References/Windows.Foundation.FoundationContract/1.0.0.0"</span>
           )) 
  (setenv <span class="org-string">"PATH"</span>
          (concat
           (getenv <span class="org-string">"PATH"</span>)
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/MSBuild/14.0/bin"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio 14.0/VC/BIN"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/WINDOWS/Microsoft.NET/Framework/v4.0.30319"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/WINDOWS/Microsoft.NET/Framework/"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/bin/x86"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft SDKs/Windows/v10.0A/bin/NETFX 4.6.1 Tools/"</span>
           )))
</pre>
</div>

<p>
M-x msbuild-215-x64-setup - Similar to previous command. 
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">msbuild-2015-x64-setup</span> ()
  (<span class="org-keyword">interactive</span>)
  <span class="org-string">"Set enviorment variables to load Microsoft Visual C++ Compiler 2015 (MSVC) 64 bits"</span>
  (setenv <span class="org-string">"PATH"</span> msbuild-old-path-var)
  (setenv <span class="org-string">"INCLUDE"</span>
          (concat 
           <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio 14.0/VC/INCLUDE"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/include/10.0.16299.0/ucrt"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/NETFXSDK/4.6.1/include/um"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/include/10.0.16299.0/shared"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/include/10.0.16299.0/um"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/include/10.0.16299.0/winrt"</span>
           ))
  (setenv <span class="org-string">"LIB"</span>
          (concat
           <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio 14.0/VC/LIB/amd64"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/lib/10.0.16299.0/ucrt/x64"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/NETFXSDK/4.6.1/lib/um/x64"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/lib/10.0.16299.0/um/x64"</span>
           ))
  (setenv <span class="org-string">"LIBPATH"</span>
          (concat 
           <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio 14.0/VC/LIB/amd64"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/WINDOWS/Microsoft.NET/Framework64/v4.0.30319"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/WINDOWS/Microsoft.NET/Framework64/"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/UnionMetadata"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/References"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/References/Windows.Foundation.UniversalApiContract/1.0.0.0"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/References/Windows.Foundation.FoundationContract/1.0.0.0"</span>           
           )) 
  (setenv <span class="org-string">"PATH"</span>
          (concat
           (getenv <span class="org-string">"PATH"</span>)
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/MSBuild/14.0/bin/amd64"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft Visual Studio 14.0/VC/BIN/amd64"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/WINDOWS/Microsoft.NET/Framework64/v4.0.30319"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/WINDOWS/Microsoft.NET/Framework64/"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/bin/x64"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Windows Kits/10/bin/x86"</span>
           <span class="org-string">";"</span> <span class="org-string">"C:/Program Files (x86)/Microsoft SDKs/Windows/v10.0A/bin/NETFX 4.6.1 Tools/x64/"</span>
           )))
</pre>
</div>

<p>
Commands to compile file related to current c++ buffer. 
</p>

<div class="org-src-container">

<pre class="src src-elisp">(<span class="org-keyword">defun</span> <span class="org-function-name">compile-msvc-2015-x86</span>()
  (<span class="org-keyword">interactive</span>)
  (msbuild-2015-x86-setup)
  (<span class="org-keyword">let</span> ((compile-command (format <span class="org-string">"cl.exe \"%s\""</span>
                                 (file-name-nondirectory (buffer-file-name))))
        (compilation-ask-about-save nil))
    (call-interactively #'compile )))

(<span class="org-keyword">defun</span> <span class="org-function-name">compile-msvc-2015-x64</span> ()
  (<span class="org-keyword">interactive</span>)
  (msbuild-2015-x64-setup)
  (<span class="org-keyword">let</span> ((compile-command (format <span class="org-string">"cl.exe \"%s\""</span>
                                 (file-name-nondirectory (buffer-file-name))))
        (compilation-ask-about-save nil))
    (call-interactively #'compile )))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-7-3" class="outline-4">
<h4 id="sec-1-7-3"><span class="section-number-4">1.7.3</span> Install C++ Compilers and MSVC Building Tools</h4>
<div class="outline-text-4" id="text-1-7-3">
<p>
The esiest and fastest way to install MSVC building tools is by using
the <a href="https://chocolatey.org/">chocolately</a> package manager which provides a Linux-like experience
for installing packages. 
</p>

<p>
Install <a href="https://chocolatey.org/packages/VisualCppBuildTools">Visual C++ Build Tools 2015 14.0.25420.1</a>
</p>

<div class="org-src-container">

<pre class="src src-sh">$ choco install visualcppbuildtools
</pre>
</div>

<p>
Install  <a href="https://chocolatey.org/packages/visualstudio2017buildtools">Visual Studio 2017 Build Tools 15.2.26430.20170650</a>
</p>

<div class="org-src-container">

<pre class="src src-sh">$ choco installvisualstudio2017buildtools
</pre>
</div>

<p>
Install <a href="https://chocolatey.org/packages/mingw">Mingw</a> - gcc/g++ GNU C/C++ Compiler ported for Windows  
</p>

<div class="org-src-container">

<pre class="src src-sh">$ choco install mingw
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-7-4" class="outline-4">
<h4 id="sec-1-7-4"><a id="ID-20becc36-1726-4965-a9ec-0977c5b7b11d" name="ID-20becc36-1726-4965-a9ec-0977c5b7b11d"></a><span class="section-number-4">1.7.4</span> Build automation tools and batch files</h4>
<div class="outline-text-4" id="text-1-7-4">

<p>
Batch files (*.bat extensions) can be used as *nix Makefiles to
perform build-automation on Windows, compile C++, C, and C# programs
and also perform a wide variety of tasks.
</p>

<p>
Example: This file <span class="underline">build.bat</span> compiles and run the file test1.cpp with
Visual C++ compiler. To build the C++ file <a href="codes/test.cpp"><a href="codes/test.cpp">codes/test.cpp</a></a>, it
just to put this file to the directory to the directory where is
test.cpp and then type in Emacs <span class="underline">M-x build</span> or <span class="underline">M-x build.bat</span>. The build
script can also be executed using the Windows shell cmd.exe, by
entering $ cd &lt;project&gt; and then typing build or build.bat.
</p>

<p>
File: <a href="codes/build.bat"><a href="codes/build.bat">codes/build.bat</a></a>
</p>

<div class="org-src-container">

<pre class="src src-bat">@<span class="org-builtin">echo</span> off

<span class="org-comment">rem  Compile for x86 or x64 bits </span>
<span class="org-comment">rem ------------------------------</span>
<span class="org-builtin">set</span> <span class="org-variable-name">MODE</span>=x86          
<span class="org-comment">rem set MODE=x64   </span>

<span class="org-comment">@REM Visual studio building tools path - Install it with chocolately </span>
<span class="org-builtin">set</span> <span class="org-variable-name">VS2017</span>=<span class="org-string">"C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\VC\Auxiliary\Build\vcvarsamd64_x86.bat"</span>
<span class="org-builtin">set</span> <span class="org-variable-name">VS2015</span>=<span class="org-string">"C:\Program Files (x86)\Microsoft Visual C++ Build Tools\vcbuildtools.bat"</span> 

<span class="org-comment">rem Save current directory     </span>
<span class="org-builtin">pushd</span> %<span class="org-variable-name">CD</span>%

<span class="org-comment">@REM Set visual Studio 2017 </span>
<span class="org-keyword">call</span> %<span class="org-constant">VS2017</span>% %<span class="org-variable-name">MODE</span>% 

<span class="org-comment">@REM Restore saved directory     </span>
<span class="org-builtin">popd</span> 

<span class="org-comment">@REM ------------------ User Command Goes Here ----------------- @REM     </span>

<span class="org-comment">@REM Build solution in Debug mode</span>
cl.exe  test.cpp &amp;&amp; test.exe 

<span class="org-comment">@REM Set /</span><span class="org-type"><span class="org-comment">p</span></span><span class="org-comment"> Wait=Build Process Completed...</span>
</pre>
</div>

<p>
This build script can be adapted to use other Windows building tools,
for instance, the line where is cl.exe could be replaced with: 
</p>

<ul class="org-ul">
<li>$ msbuild WpfAppLearning.sln /p:Configuration=Release /p:Platform="Any CPU"
<ul class="org-ul">
<li>To build a Visual studio solution (aka project).
</li>
</ul>
</li>

<li>$ Devenv WpfAppLearning.sln /Rebuild Debug
<ul class="org-ul">
<li>Rebuild applicatio with Visual Studio Command line switch.
</li>
</ul>
</li>

<li>$ fsc.exe app1.fsx &lt;flags&gt;
<ul class="org-ul">
<li>Compile a F# application
</li>
</ul>
</li>

<li>$ csc.exe app1.cs
<ul class="org-ul">
<li>Compile a C# application
</li>
</ul>
</li>

<li>$ scalac app1.scala -d app1.jar &amp;&amp; scala app1.jar
<ul class="org-ul">
<li>Compile a Scala application and run it.
</li>
</ul>
</li>
</ul>

<p>
It is also worth knowing some DOS / Windows command line tools for
compiling applications on Windows. 
</p>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Action</th>
<th scope="col" class="left">Windows command prompt window</th>
<th scope="col" class="left">OS X Terminal or X11 window</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">Clear terminal</td>
<td class="left">cls</td>
<td class="left">clear</td>
</tr>

<tr>
<td class="left">Change to a different directory</td>
<td class="left">cd</td>
<td class="left">cd</td>
</tr>

<tr>
<td class="left">Make a new directory</td>
<td class="left">mkdir or md</td>
<td class="left">mkdir</td>
</tr>

<tr>
<td class="left">Delete a directory</td>
<td class="left">rmdir or rd</td>
<td class="left">rmdir</td>
</tr>

<tr>
<td class="left">List file directory in chronological order with detail</td>
<td class="left">dir /od</td>
<td class="left">ls -ltr</td>
</tr>

<tr>
<td class="left">Copy a file, preserving its date-time stamp</td>
<td class="left">copy &lt;file&gt; &lt;dest&gt;</td>
<td class="left">cp -p</td>
</tr>

<tr>
<td class="left">Display contents of a text file</td>
<td class="left">type &lt;file&gt;</td>
<td class="left">cat &lt;file&gt;</td>
</tr>

<tr>
<td class="left">Delete a file</td>
<td class="left">erase</td>
<td class="left">rm</td>
</tr>

<tr>
<td class="left">Move a file</td>
<td class="left">move</td>
<td class="left">mv</td>
</tr>

<tr>
<td class="left">Rename a file</td>
<td class="left">ren</td>
<td class="left">mv</td>
</tr>

<tr>
<td class="left">Find a file</td>
<td class="left">dir /s</td>
<td class="left">find</td>
</tr>

<tr>
<td class="left">Grep a file</td>
<td class="left">findstr</td>
<td class="left">grep</td>
</tr>

<tr>
<td class="left">Display differences between two text files</td>
<td class="left">fc</td>
<td class="left">diff</td>
</tr>

<tr>
<td class="left">Change file attributes</td>
<td class="left">attrib</td>
<td class="left">chmod</td>
</tr>

<tr>
<td class="left">“Super-user” root authorization</td>
<td class="left">N/A</td>
<td class="left">sudo</td>
</tr>

<tr>
<td class="left">Create symbolic link to a file or directory</td>
<td class="left">N/A</td>
<td class="left">ln</td>
</tr>

<tr>
<td class="left">Shrink executable file size</td>
<td class="left">strip (included w/ Free Pascal)</td>
<td class="left">strip</td>
</tr>

<tr>
<td class="left">Show environment variables</td>
<td class="left">set</td>
<td class="left">env</td>
</tr>

<tr>
<td class="left">Set environment variable</td>
<td class="left">set PATH=%PATH%;E:/dir/bin</td>
<td class="left">export PATH=$PATH:/dir/bin</td>
</tr>

<tr>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2018-03-19 Mon 14:23</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.3.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
